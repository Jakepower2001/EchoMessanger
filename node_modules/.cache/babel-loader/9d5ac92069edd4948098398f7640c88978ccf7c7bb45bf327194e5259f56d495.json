{"ast":null,"code":"var _jsxFileName = \"C:\\\\messagingapp\\\\firebase-react-messaging-app\\\\src\\\\components\\\\Chat.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { auth, db } from \"../firebase/config\";\nimport { collection, addDoc, query, where, orderBy, onSnapshot } from \"firebase/firestore\";\nimport UserList from \"./UserList\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = () => {\n  _s();\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  useEffect(() => {\n    var _auth$currentUser, _auth$currentUser2;\n    if (!selectedUser) return;\n    const q = query(collection(db, \"messages\"), where(\"from\", \"in\", [(_auth$currentUser = auth.currentUser) === null || _auth$currentUser === void 0 ? void 0 : _auth$currentUser.uid, selectedUser.uid]), where(\"to\", \"in\", [(_auth$currentUser2 = auth.currentUser) === null || _auth$currentUser2 === void 0 ? void 0 : _auth$currentUser2.uid, selectedUser.uid]), orderBy(\"createdAt\"));\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const msgs = [];\n      snapshot.forEach(doc => {\n        msgs.push({\n          id: doc.id,\n          ...doc.data()\n        });\n      });\n      setMessages(msgs);\n    });\n    return () => unsubscribe();\n  }, [selectedUser]);\n  const sendMessage = async e => {\n    var _auth$currentUser3;\n    e.preventDefault();\n    if (!newMessage.trim() || !selectedUser) return;\n    await addDoc(collection(db, \"messages\"), {\n      text: newMessage,\n      from: (_auth$currentUser3 = auth.currentUser) === null || _auth$currentUser3 === void 0 ? void 0 : _auth$currentUser3.uid,\n      to: selectedUser.uid,\n      createdAt: new Date()\n    });\n    setNewMessage(\"\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(UserList, {\n      onSelect: setSelectedUser\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), selectedUser && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Chat with \", selectedUser.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: messages.map(msg => {\n          var _auth$currentUser4;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: [msg.from === ((_auth$currentUser4 = auth.currentUser) === null || _auth$currentUser4 === void 0 ? void 0 : _auth$currentUser4.uid) ? \"Me\" : selectedUser.name, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 58,\n              columnNumber: 17\n            }, this), \" \", msg.text]\n          }, msg.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: sendMessage,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: newMessage,\n          onChange: e => setNewMessage(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n};\n_s(Chat, \"2mOHr5v4U238cA/diUbjvSV0Tto=\");\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","auth","db","collection","addDoc","query","where","orderBy","onSnapshot","UserList","jsxDEV","_jsxDEV","Chat","_s","selectedUser","setSelectedUser","messages","setMessages","newMessage","setNewMessage","_auth$currentUser","_auth$currentUser2","q","currentUser","uid","unsubscribe","snapshot","msgs","forEach","doc","push","id","data","sendMessage","e","_auth$currentUser3","preventDefault","trim","text","from","to","createdAt","Date","children","onSelect","fileName","_jsxFileName","lineNumber","columnNumber","name","map","msg","_auth$currentUser4","onSubmit","value","onChange","target","type","_c","$RefreshReg$"],"sources":["C:/messagingapp/firebase-react-messaging-app/src/components/Chat.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { auth, db } from \"../firebase/config\";\nimport { collection, addDoc, query, where, orderBy, onSnapshot } from \"firebase/firestore\";\nimport UserList from \"./UserList\";\n\ntype Message = {\n  id?: string;\n  text: string;\n  from: string;\n  to: string;\n  createdAt: any;\n};\n\nconst Chat: React.FC = () => {\n  const [selectedUser, setSelectedUser] = useState<any>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n\n  useEffect(() => {\n    if (!selectedUser) return;\n    const q = query(\n      collection(db, \"messages\"),\n      where(\"from\", \"in\", [auth.currentUser?.uid, selectedUser.uid]),\n      where(\"to\", \"in\", [auth.currentUser?.uid, selectedUser.uid]),\n      orderBy(\"createdAt\")\n    );\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const msgs: Message[] = [];\n      snapshot.forEach(doc => {\n        msgs.push({ id: doc.id, ...(doc.data() as Message) });\n      });\n      setMessages(msgs);\n    });\n    return () => unsubscribe();\n  }, [selectedUser]);\n\n  const sendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !selectedUser) return;\n    await addDoc(collection(db, \"messages\"), {\n      text: newMessage,\n      from: auth.currentUser?.uid,\n      to: selectedUser.uid,\n      createdAt: new Date(),\n    });\n    setNewMessage(\"\");\n  };\n\n  return (\n    <div>\n      <UserList onSelect={setSelectedUser} />\n      {selectedUser && (\n        <div>\n          <h3>Chat with {selectedUser.name}</h3>\n          <div>\n            {messages.map(msg => (\n              <div key={msg.id}>\n                <b>{msg.from === auth.currentUser?.uid ? \"Me\" : selectedUser.name}:</b> {msg.text}\n              </div>\n            ))}\n          </div>\n          <form onSubmit={sendMessage}>\n            <input value={newMessage} onChange={e => setNewMessage(e.target.value)} />\n            <button type=\"submit\">Send</button>\n          </form>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}