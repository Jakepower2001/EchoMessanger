{"ast":null,"code":"import React,{useState}from\"react\";import{auth,db,storage}from\"../firebase/config\";import{createUserWithEmailAndPassword,updateProfile}from\"firebase/auth\";import{addDoc,collection}from\"firebase/firestore\";import{ref,uploadBytes,getDownloadURL}from\"firebase/storage\";import{useHistory}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Signup=()=>{const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[name,setName]=useState(\"\");const[avatar,setAvatar]=useState(null);const history=useHistory();const handleSignup=async e=>{e.preventDefault();console.log(\"Signup started\");try{const userCredential=await createUserWithEmailAndPassword(auth,email,password);console.log(\"User created:\",userCredential.user.uid);let avatarUrl=\"\";if(avatar){console.log(\"Uploading avatar...\");const avatarRef=ref(storage,\"avatars/\".concat(userCredential.user.uid));try{await uploadBytes(avatarRef,avatar);console.log(\"Avatar uploaded to storage\");avatarUrl=await getDownloadURL(avatarRef);console.log(\"Avatar URL:\",avatarUrl);await updateProfile(userCredential.user,{photoURL:avatarUrl});console.log(\"Profile updated with avatar\");}catch(err){console.error(\"Avatar upload failed:\",err);alert(\"Avatar upload failed: \"+err.message);}}await addDoc(collection(db,\"users\"),{uid:userCredential.user.uid,name,email,avatar:avatarUrl});console.log(\"User added to Firestore\");window.location.href=\"/login\";console.log(\"Redirected to login\");}catch(error){console.error(\"Signup error:\",error);alert(error.message);}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSignup,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sign Up\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Name\",value:name,onChange:e=>setName(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Email\",value:email,onChange:e=>setEmail(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>{var _e$target$files;return setAvatar(((_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0])||null);}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Sign Up\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",style:{marginTop:\"1em\"},onClick:()=>window.location.href=\"/login\",children:\"Test Redirect\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Already have an account? \",/*#__PURE__*/_jsx(\"a\",{href:\"/login\",children:\"Login\"})]})]});};export default Signup;","map":{"version":3,"names":["React","useState","auth","db","storage","createUserWithEmailAndPassword","updateProfile","addDoc","collection","ref","uploadBytes","getDownloadURL","useHistory","jsx","_jsx","jsxs","_jsxs","Signup","email","setEmail","password","setPassword","name","setName","avatar","setAvatar","history","handleSignup","e","preventDefault","console","log","userCredential","user","uid","avatarUrl","avatarRef","concat","photoURL","err","error","alert","message","window","location","href","onSubmit","children","placeholder","value","onChange","target","required","type","accept","_e$target$files","files","style","marginTop","onClick"],"sources":["C:/messagingapp/firebase-react-messaging-app/src/components/Signup.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { auth, db, storage } from \"../firebase/config\";\nimport { createUserWithEmailAndPassword, updateProfile } from \"firebase/auth\";\nimport { addDoc, collection } from \"firebase/firestore\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { useHistory } from \"react-router-dom\";\n\nconst Signup: React.FC = () => {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [avatar, setAvatar] = useState<File | null>(null);\n  const history = useHistory();\n\n  const handleSignup = async (e: React.FormEvent) => {\n    e.preventDefault();\n    console.log(\"Signup started\");\n    try {\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n      console.log(\"User created:\", userCredential.user.uid);\n      let avatarUrl = \"\";\n      if (avatar) {\n        console.log(\"Uploading avatar...\");\n        const avatarRef = ref(storage, `avatars/${userCredential.user.uid}`);\n        try {\n          await uploadBytes(avatarRef, avatar);\n          console.log(\"Avatar uploaded to storage\");\n          avatarUrl = await getDownloadURL(avatarRef);\n          console.log(\"Avatar URL:\", avatarUrl);\n          await updateProfile(userCredential.user, { photoURL: avatarUrl });\n          console.log(\"Profile updated with avatar\");\n        } catch (err: any) {\n          console.error(\"Avatar upload failed:\", err);\n          alert(\"Avatar upload failed: \" + err.message);\n        }\n      }\n      await addDoc(collection(db, \"users\"), {\n        uid: userCredential.user.uid,\n        name,\n        email,\n        avatar: avatarUrl,\n      });\n      console.log(\"User added to Firestore\");\n      window.location.href = \"/login\";\n      console.log(\"Redirected to login\");\n    } catch (error: any) {\n      console.error(\"Signup error:\", error);\n      alert(error.message);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSignup}>\n      <h2>Sign Up</h2>\n      <input\n        placeholder=\"Name\"\n        value={name}\n        onChange={e => setName(e.target.value)}\n        required\n      />\n      <input\n        placeholder=\"Email\"\n        value={email}\n        onChange={e => setEmail(e.target.value)}\n        required\n      />\n      <input\n        type=\"password\"\n        placeholder=\"Password\"\n        value={password}\n        onChange={e => setPassword(e.target.value)}\n        required\n      />\n      <input\n        type=\"file\"\n        accept=\"image/*\"\n        onChange={e => setAvatar(e.target.files?.[0] || null)}\n      />\n      <button type=\"submit\">Sign Up</button>\n      <button\n        type=\"button\"\n        style={{ marginTop: \"1em\" }}\n        onClick={() => window.location.href = \"/login\"}\n      >\n        Test Redirect\n      </button>\n      <p>\n        Already have an account? <a href=\"/login\">Login</a>\n      </p>\n    </form>\n  );\n};\n\nexport default Signup;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}